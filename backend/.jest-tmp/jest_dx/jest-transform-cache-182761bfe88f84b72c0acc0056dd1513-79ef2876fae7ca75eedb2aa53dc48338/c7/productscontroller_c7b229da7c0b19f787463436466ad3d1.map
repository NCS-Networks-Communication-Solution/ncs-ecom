{"file":"/Users/pkaewmanee/Desktop/Project_Hiroshima/ncs-ecom/backend/src/products/products.controller.ts","mappings":";;;;;;;;;;;;;;;AAAA,2CAWwB;AACxB,yDAAqD;AACrD,+CAA6C;AAC7C,0EAA6D;AAC7D,8DAA0D;AAC1D,iEAA4D;AAC5D,iEAA4D;AAGrD,IAAM,kBAAkB,GAAxB,MAAM,kBAAkB;IAC7B,YAAoB,eAAgC;QAAhC,oBAAe,GAAf,eAAe,CAAiB;IAAG,CAAC;IAGlD,AAAN,KAAK,CAAC,OAAO,CACM,MAAe,EACX,UAAmB,EACrB,QAAiB,EACjB,QAAiB,EACrB,IAAa,EACZ,KAAc;QAE9B,MAAM,UAAU,GAAG,IAAI,CAAC,oBAAoB,CAAC,IAAI,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;QAC9D,MAAM,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,oBAAoB,CAAC,KAAK,EAAE,EAAE,EAAE,OAAO,CAAC,EAAE,GAAG,CAAC,CAAC;QAEjF,MAAM,cAAc,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;QAC9D,MAAM,cAAc,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;QAE9D,OAAO,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC;YAClC,MAAM;YACN,UAAU;YACV,QAAQ,EAAE,cAAc;YACxB,QAAQ,EAAE,cAAc;YACxB,IAAI,EAAE,UAAU;YAChB,KAAK,EAAE,WAAW;SACnB,CAAC,CAAC;IACL,CAAC;IAGK,AAAN,KAAK,CAAC,OAAO,CAAc,EAAU;QACnC,OAAO,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IAC1C,CAAC;IAKK,AAAN,KAAK,CAAC,MAAM,CAAS,GAAqB;QACxC,OAAO,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;IAC1C,CAAC;IAKK,AAAN,KAAK,CAAC,MAAM,CAAc,EAAU,EAAU,GAAqB;QACjE,OAAO,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;IAC9C,CAAC;IAKK,AAAN,KAAK,CAAC,MAAM,CAAc,EAAU;QAClC,OAAO,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;IACzC,CAAC;IAEO,oBAAoB,CAAC,KAAyB,EAAE,QAAgB,EAAE,KAAa;QACrF,IAAI,KAAK,KAAK,SAAS,EAAE,CAAC;YACxB,OAAO,QAAQ,CAAC;QAClB,CAAC;QAED,MAAM,MAAM,GAAG,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;QACnC,IAAI,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,MAAM,GAAG,CAAC,EAAE,CAAC;YACvC,MAAM,IAAI,4BAAmB,CAAC,GAAG,KAAK,6BAA6B,CAAC,CAAC;QACvE,CAAC;QAED,OAAO,MAAM,CAAC;IAChB,CAAC;IAEO,WAAW,CAAC,KAAyB,EAAE,KAAa;QAC1D,IAAI,KAAK,KAAK,SAAS,EAAE,CAAC;YACxB,OAAO,SAAS,CAAC;QACnB,CAAC;QAED,MAAM,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;QAC7B,IAAI,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC;YACzB,MAAM,IAAI,4BAAmB,CAAC,GAAG,KAAK,mBAAmB,CAAC,CAAC;QAC7D,CAAC;QAED,OAAO,MAAM,CAAC;IAChB,CAAC;CACF,CAAA;AA/EY,gDAAkB;AAIvB;IADL,IAAA,YAAG,GAAE;IAEH,WAAA,IAAA,cAAK,EAAC,QAAQ,CAAC,CAAA;IACf,WAAA,IAAA,cAAK,EAAC,YAAY,CAAC,CAAA;IACnB,WAAA,IAAA,cAAK,EAAC,UAAU,CAAC,CAAA;IACjB,WAAA,IAAA,cAAK,EAAC,UAAU,CAAC,CAAA;IACjB,WAAA,IAAA,cAAK,EAAC,MAAM,CAAC,CAAA;IACb,WAAA,IAAA,cAAK,EAAC,OAAO,CAAC,CAAA;;;;iDAgBhB;AAGK;IADL,IAAA,YAAG,EAAC,KAAK,CAAC;IACI,WAAA,IAAA,cAAK,EAAC,IAAI,CAAC,CAAA;;;;iDAEzB;AAKK;IAHL,IAAA,aAAI,GAAE;IACN,IAAA,kBAAS,EAAC,IAAA,oBAAS,EAAC,KAAK,CAAC,EAAE,wBAAU,CAAC;IACvC,IAAA,uBAAK,EAAC,OAAO,EAAE,UAAU,CAAC;IACb,WAAA,IAAA,aAAI,GAAE,CAAA;;qCAAM,qCAAgB;;gDAEzC;AAKK;IAHL,IAAA,YAAG,EAAC,KAAK,CAAC;IACV,IAAA,kBAAS,EAAC,IAAA,oBAAS,EAAC,KAAK,CAAC,EAAE,wBAAU,CAAC;IACvC,IAAA,uBAAK,EAAC,OAAO,EAAE,UAAU,CAAC;IACb,WAAA,IAAA,cAAK,EAAC,IAAI,CAAC,CAAA;IAAc,WAAA,IAAA,aAAI,GAAE,CAAA;;6CAAM,qCAAgB;;gDAElE;AAKK;IAHL,IAAA,eAAM,EAAC,KAAK,CAAC;IACb,IAAA,kBAAS,EAAC,IAAA,oBAAS,EAAC,KAAK,CAAC,EAAE,wBAAU,CAAC;IACvC,IAAA,uBAAK,EAAC,OAAO,CAAC;IACD,WAAA,IAAA,cAAK,EAAC,IAAI,CAAC,CAAA;;;;gDAExB;6BApDU,kBAAkB;IAD9B,IAAA,mBAAU,EAAC,UAAU,CAAC;qCAEgB,kCAAe;GADzC,kBAAkB,CA+E9B","names":[],"sources":["/Users/pkaewmanee/Desktop/Project_Hiroshima/ncs-ecom/backend/src/products/products.controller.ts"],"sourcesContent":["import {\n  BadRequestException,\n  Body,\n  Controller,\n  Delete,\n  Get,\n  Param,\n  Post,\n  Put,\n  Query,\n  UseGuards,\n} from '@nestjs/common';\nimport { ProductsService } from './products.service';\nimport { AuthGuard } from '@nestjs/passport';\nimport { Roles } from '../common/decorators/roles.decorator';\nimport { RolesGuard } from '../common/guards/roles.guard';\nimport { CreateProductDto } from './dto/create-product.dto';\nimport { UpdateProductDto } from './dto/update-product.dto';\n\n@Controller('products')\nexport class ProductsController {\n  constructor(private productsService: ProductsService) {}\n\n  @Get()\n  async findAll(\n    @Query('search') search?: string,\n    @Query('categoryId') categoryId?: string,\n    @Query('minPrice') minPrice?: string,\n    @Query('maxPrice') maxPrice?: string,\n    @Query('page') page?: string,\n    @Query('limit') limit?: string,\n  ) {\n    const parsedPage = this.parsePositiveInteger(page, 1, 'page');\n    const parsedLimit = Math.min(this.parsePositiveInteger(limit, 20, 'limit'), 100);\n\n    const parsedMinPrice = this.parseNumber(minPrice, 'minPrice');\n    const parsedMaxPrice = this.parseNumber(maxPrice, 'maxPrice');\n\n    return this.productsService.findAll({\n      search,\n      categoryId,\n      minPrice: parsedMinPrice,\n      maxPrice: parsedMaxPrice,\n      page: parsedPage,\n      limit: parsedLimit,\n    });\n  }\n\n  @Get(':id')\n  async findOne(@Param('id') id: string) {\n    return this.productsService.findOne(id);\n  }\n\n  @Post()\n  @UseGuards(AuthGuard('jwt'), RolesGuard)\n  @Roles('ADMIN', 'APPROVER')\n  async create(@Body() dto: CreateProductDto) {\n    return this.productsService.create(dto);\n  }\n\n  @Put(':id')\n  @UseGuards(AuthGuard('jwt'), RolesGuard)\n  @Roles('ADMIN', 'APPROVER')\n  async update(@Param('id') id: string, @Body() dto: UpdateProductDto) {\n    return this.productsService.update(id, dto);\n  }\n\n  @Delete(':id')\n  @UseGuards(AuthGuard('jwt'), RolesGuard)\n  @Roles('ADMIN')\n  async remove(@Param('id') id: string) {\n    return this.productsService.remove(id);\n  }\n\n  private parsePositiveInteger(value: string | undefined, fallback: number, field: string) {\n    if (value === undefined) {\n      return fallback;\n    }\n\n    const parsed = parseInt(value, 10);\n    if (Number.isNaN(parsed) || parsed < 1) {\n      throw new BadRequestException(`${field} must be a positive integer`);\n    }\n\n    return parsed;\n  }\n\n  private parseNumber(value: string | undefined, field: string) {\n    if (value === undefined) {\n      return undefined;\n    }\n\n    const parsed = Number(value);\n    if (Number.isNaN(parsed)) {\n      throw new BadRequestException(`${field} must be a number`);\n    }\n\n    return parsed;\n  }\n}\n"],"version":3}