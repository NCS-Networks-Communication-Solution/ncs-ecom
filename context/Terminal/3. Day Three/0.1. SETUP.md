# NCS B2B E-Commerce Platform - Complete Setup Commands

## Overview
This guide contains all the terminal commands you need to set up your NCS e-commerce project from a clean computer state. The commands are organized in the proper sequence based on your project files.

## Prerequisites
- macOS system (since your files show MacBook Pro usage)
- Clean system with only the `ncs-ecom` project saved on your hard drive
- Terminal access

---

## 1. Environment Setup

```bash
# Install Homebrew (if not already installed)
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# Install Node Version Manager and essential tools
brew install nvm docker jq gh

# Create NVM directory
mkdir -p ~/.nvm

# Add nvm to your shell profile
echo 'export NVM_DIR="$HOME/.nvm"' >> ~/.zshrc
echo '[ -s "/opt/homebrew/bin/nvm.sh" ] && \. "/opt/homebrew/bin/nvm.sh"' >> ~/.zshrc
echo '[ -s "/opt/homebrew/etc/bash_completion.d/nvm" ] && \. "/opt/homebrew/etc/bash_completion.d/nvm"' >> ~/.zshrc

# Reload shell configuration
source ~/.zshrc

# Install Node 18 LTS
nvm install --lts
nvm use --lts

# Verify installations
node -v
npm -v
docker --version
gh --version

# Authenticate with GitHub
gh auth login
```

---

## 2. Git Repository Setup

```bash
# Navigate to your saved ncs-ecom directory
cd ~/ncs-ecom  # or wherever you saved it

# Verify current directory and files
pwd
ls -la

# Configure git if needed (replace with your details)
git config --global user.name "Phakkhapon Kaewmanee"
git config --global user.email "fishermanfill01@gmail.com"

# Check git status and remote
git status
git remote -v

# Pull latest changes if needed
git pull origin main
```

---

## 3. Docker Compose Setup

```bash
# Create docker-compose.yml file
cat > docker-compose.yml << 'EOF'
version: '3.8'
services:
  postgres:
    image: postgres:15-alpine
    environment:
      POSTGRES_DB: ncsdb
      POSTGRES_USER: ncsadmin
      POSTGRES_PASSWORD: ${DB_PASSWORD:-defaultpass}
    volumes:
      - pgdata:/var/lib/postgresql/data
    ports:
      - "5432:5432"
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U ncsadmin"]
      interval: 10s
      timeout: 5s
      retries: 5
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    volumes:
      - redisdata:/data
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 5s
      retries: 5
volumes:
  pgdata:
  redisdata:
EOF

# Create .env file with database credentials
cat > .env << 'EOF'
NODE_ENV=development
DB_PASSWORD=ncs2025secure
DATABASE_URL=postgresql://ncsadmin:ncs2025secure@localhost:5432/ncsdb
REDIS_URL=redis://localhost:6379
JWT_SECRET=ncs-jwt-secret-dev-2025
EOF

# Start Docker services
docker compose up -d

# Verify services are running
docker compose ps

# Test database connection
docker exec -it ncs-ecom-postgres-1 psql -U ncsadmin -d ncsdb -c '\l'

# Test Redis connection
docker exec -it ncs-ecom-redis-1 redis-cli ping
```

---

## 4. Project Structure Setup

```bash
# Create necessary directories
mkdir -p backend/src
mkdir -p frontend/src
mkdir -p spec
mkdir -p backend/contracts/dto
mkdir -p .github/workflows
mkdir -p .github/ISSUE_TEMPLATE

# Initialize backend if not exists
if [ ! -d "backend/node_modules" ]; then
    cd backend
    npx @nestjs/cli new . --skip-git --package-manager npm
    cd ..
fi

# Initialize frontend if not exists  
if [ ! -d "frontend/node_modules" ]; then
    cd frontend
    npx create-next-app@latest . --typescript --eslint --tailwind --src-dir --app --turbopack --import-alias "@/*"
    cd ..
fi
```

---

## 5. Backend Setup

```bash
cd backend

# Install backend dependencies
npm install prisma @prisma/client @nestjs/jwt @nestjs/passport passport passport-jwt bcrypt

# Initialize Prisma
npx prisma init

# Create basic Prisma schema
cat > prisma/schema.prisma << 'EOF'
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       String @id @default(uuid())
  email    String @unique
  password String
  name     String
  role     Role   @default(USER)
}

enum Role {
  USER
  ADMIN
}
EOF

# Create .env.example for backend
cat > .env.example << 'EOF'
DATABASE_URL="postgresql://ncsadmin:password@localhost:5432/ncsdb?schema=public" 
REDIS_URL="redis://localhost:6379"
JWT_SECRET="your-jwt-secret-key-here"
JWT_EXPIRES_IN="7d"
PORT=3001
NODE_ENV=development
EOF

# Copy environment variables
cp ../.env .env

cd ..
```

---

## 6. Frontend Setup

```bash
cd frontend

# Install additional dependencies
npm install axios

# Create .env.example for frontend
cat > .env.example << 'EOF'
NEXT_PUBLIC_API_URL="http://localhost:3001/api"
NEXT_PUBLIC_APP_URL="http://localhost:3000"
NEXT_PUBLIC_ENABLE_PROMPTPAY="true"
NEXT_PUBLIC_ENABLE_THAI_TAX="true"
EOF

# Create .env.local for development
cat > .env.local << 'EOF'
NEXT_PUBLIC_API_URL=http://localhost:3001/api
NEXT_PUBLIC_APP_URL=http://localhost:3000
NEXT_PUBLIC_ENABLE_PROMPTPAY=true
NEXT_PUBLIC_ENABLE_THAI_TAX=true
EOF

cd ..
```

---

## 7. CI/CD Pipeline Setup

```bash
# Create GitHub Actions workflow
cat > .github/workflows/ci.yml << 'EOF'
name: CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  backend:
    name: Backend CI
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          cache-dependency-path: backend/package-lock.json
      - name: Install dependencies
        working-directory: backend
        run: npm ci
      - name: Run linting
        working-directory: backend
        run: npm run lint --if-present
      - name: Run build
        working-directory: backend
        run: npm run build --if-present
      - name: Run tests
        working-directory: backend
        run: npm run test --if-present || echo "No backend tests configured"

  frontend:
    name: Frontend CI
    runs-on: ubuntu-latest  
    steps:
      - uses: actions/checkout@v4
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          cache-dependency-path: frontend/package-lock.json
      - name: Install dependencies
        working-directory: frontend
        run: npm ci
      - name: Run linting
        working-directory: frontend
        run: npm run lint --if-present
      - name: Type check
        working-directory: frontend
        run: npx tsc --noEmit || true
      - name: Run build
        working-directory: frontend
        run: npm run build --if-present
      - name: Run tests
        working-directory: frontend
        run: npm run test --if-present || echo "No frontend tests configured"
EOF
```

---

## 8. GitHub Issue Templates

```bash
# Create bug report template
cat > .github/ISSUE_TEMPLATE/bug_report.md << 'EOF'
---
name: Bug report
about: Report a problem or unexpected behavior
title: "[BUG] REQ-XYZ-??: "
labels: bug
---

**Describe the bug**  
A clear and concise description of what the bug is.

**To Reproduce**  
Steps to reproduce the behavior.

**Expected behavior**  
A clear description of what you expected to happen.

**Environment (please complete the following information):**
- OS:
- Browser:

**Additional context**  
Add any other context about the problem here.
EOF

# Create feature request template
cat > .github/ISSUE_TEMPLATE/feature_request.md << 'EOF'
---
name: Feature request
about: Suggest a new feature or enhancement
title: "[FEAT] REQ-XYZ-??: "
labels: enhancement
---

**Describe the solution you'd like**  
A clear description of what you want to happen.

**Acceptance Criteria**  
- Criterion 1
- Criterion 2

**Additional context**  
Add any other context or screenshots about the feature request here.
EOF
```

---

## 9. Update .gitignore

```bash
# Update .gitignore to ensure sensitive files are not committed
cat >> .gitignore << 'EOF'
# Environment variables
.env
.env.local
.env.*.local

# Dependencies
node_modules/

# Build outputs
.next/
dist/
build/

# Logs
*.log

# Database
*.db
*.sqlite

# IDE
.vscode/
.idea/
EOF
```

---

## 10. Verification Commands

```bash
# Verify environment setup
echo "=== Environment Verification ==="
node -v
npm -v
gh auth status
docker --version
docker compose version

# Verify project structure
echo "=== Project Structure ==="
ls -la
ls -la backend/ 2>/dev/null || echo "Backend directory not found"
ls -la frontend/ 2>/dev/null || echo "Frontend directory not found"

# Verify Docker services
echo "=== Docker Services ==="
docker compose ps
docker compose logs postgres --tail=10
docker compose logs redis --tail=10

# Test database connection
echo "=== Database Test ==="
docker exec -it ncs-ecom-postgres-1 psql -U ncsadmin -d ncsdb -c "SELECT version();"

# Test Redis connection
echo "=== Redis Test ==="
docker exec -it ncs-ecom-redis-1 redis-cli ping
```

---

## 11. Final Setup Steps

```bash
# Commit all changes
git add .
git commit -m "chore: complete project setup with Docker Compose, CI/CD, and templates"
git push origin main

echo "============================================================"
echo "ðŸŽ‰ SETUP COMPLETE!"
echo "============================================================"
echo "Your NCS B2B E-Commerce platform is now ready for development."
echo ""
echo "Quick start commands:"
echo "  docker compose up -d     # Start all services"
echo "  cd backend && npm run start:dev  # Start backend development"
echo "  cd frontend && npm run dev       # Start frontend development"
echo ""
echo "Access your application:"
echo "  Frontend: http://localhost:3000"
echo "  Backend API: http://localhost:3001" 
echo "  PostgreSQL: localhost:5432 (user: ncsadmin, password: ncs2025secure)"
echo "  Redis: localhost:6379"
echo "============================================================"
```

---

## Development Commands (After Setup)

Once setup is complete, use these commands for daily development:

```bash
# Start all services
docker compose up -d

# Start backend development server
cd backend
npm run start:dev

# In a new terminal, start frontend development server
cd frontend
npm run dev

# Stop all services when done
docker compose down

# View service logs
docker compose logs -f postgres
docker compose logs -f redis

# Connect to database directly
docker exec -it ncs-ecom-postgres-1 psql -U ncsadmin -d ncsdb

# Run database migrations (when you have them)
cd backend
npx prisma migrate dev

# Generate Prisma client after schema changes
npx prisma generate
```

---

## Troubleshooting

If you encounter issues:

1. **Docker not starting**: Make sure Docker Desktop is running
2. **Port conflicts**: Check if ports 3000, 3001, 5432, 6379 are available
3. **Permission issues**: Run `sudo chmod +x` on any shell scripts
4. **Database connection issues**: Ensure PostgreSQL container is healthy: `docker compose ps`
5. **Node version issues**: Verify you're using Node 18 LTS: `nvm use --lts`

This comprehensive setup script recreates your entire development environment based on the evidence from your project files[1][2][3].